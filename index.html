<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>Noktra Airdrop</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="logo.png">
  <meta property="og:title" content="Noktra Airdrop">
  <meta property="og:description" content="Noktra — zdecentralizowany token społecznościowy na Solanie.">
  <meta property="og:image" content="logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <style>
    .linklike{background:none;border:none;color:#00ffcc;cursor:pointer;text-decoration:underline;padding:0;margin-left:8px;font:inherit}
    #toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:rgba(0,0,0,.75);color:#fff;padding:8px 12px;border-radius:6px;opacity:0;pointer-events:none;transition:opacity .2s;font-size:.9rem;z-index:99999}
    #toast.show{opacity:1}
    .lightbox-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center;z-index:9999}
    .lightbox-backdrop img{max-width:90vw;max-height:90vh;border-radius:8px;box-shadow:0 0 20px rgba(0,0,0,.6)}
    html{scroll-behavior:smooth}
    .nft-card{transition:transform .25s ease, box-shadow .25s ease}
    .nft-card:hover{transform:translateY(-4px) scale(1.02); box-shadow:0 0 24px rgba(0,255,204,.35)}
    .reveal{opacity:0; transform:translateY(16px); transition:opacity .5s ease, transform .5s ease}
    .reveal.visible{opacity:1; transform:none}
    .share-row{margin-top:10px; text-align:center}
    .share-row a{color:#00ffcc; margin:0 8px; text-decoration:underline}
    .neon-ornament{display:flex;justify-content:center;margin:6px 0 14px}
    .neon-ornament svg{height:18px;filter:drop-shadow(0 0 8px rgba(0,255,204,.5))}
    .neon-ornament path{stroke:url(#grad-neon);stroke-width:3;fill:none;stroke-linecap:round;opacity:.9;stroke-dasharray:180;animation:dash 12s linear infinite}
    @keyframes dash{to{stroke-dashoffset:-360}}

    /* Splash startowy: logo full-screen + fade+blur */
    body.splash-lock{overflow:hidden}
    .splash{
      position:fixed; inset:0; z-index:100000; display:flex; flex-direction:column; align-items:center; justify-content:center;
      background:radial-gradient(60% 60% at 50% 50%, rgba(0,0,0,.6), rgba(0,0,0,.92) 60%);
      backdrop-filter:blur(2px);
      opacity:1; transition:opacity .7s ease;
    }
    .splash.hide{opacity:0; pointer-events:none; visibility:hidden}
    .splash .mark{
      width:min(92vmin, 96vw); height:auto;
      filter:drop-shadow(0 0 26px rgba(0,255,204,.55));
      transition:transform .6s ease, filter .6s ease, opacity .6s ease;
    }
    .splash.play .mark{animation:logoFade 1.4s ease .4s forwards}
    @keyframes logoFade{
      to{opacity:0; filter:blur(18px) brightness(1.15); transform:scale(1.06)}
    }
    .splash .title{
      margin-top:10px;
      font-size:clamp(18px,3.6vw,28px); color:#00ffcc; letter-spacing:1.2px; font-weight:700; text-align:center;
      text-shadow:0 0 16px rgba(0,255,204,.65), 0 0 28px rgba(0,255,204,.35);
      opacity:.95;
    }

    /* Mobile-safe dodatki (bez zmiany wyglądu) */
    html, body { overflow-x: hidden; }
    img { max-width: 100%; height: auto; }
    @media (max-width: 768px) {
      .background { background-attachment: scroll; }
    }
    @supports (padding: max(0px)) {
      body { padding-left: env(safe-area-inset-left); padding-right: env(safe-area-inset-right); }
    }
  </style>
  <script>window.NOKTRA_BACKEND_URL="https://noktra-airdrop-6r387ygq6-noktras-projects.vercel.app/api";</script>
</head>
<body>
  <div class="top-link">
    <a href="#nft-gallery">Gallery NFT Noktra</a>
  </div>
  <div class="background"></div>
  <img src="logo.png" alt="Noktra Logo" class="corner-logo" decoding="async" />

  <!-- Splash: logo full-screen + komunikat EN -->
  <div id="splash" class="splash" aria-hidden="true">
    <img class="mark" src="logo.png" alt="">
    <div class="title" data-pl="NOKTRA THANKS YOU FOR BEING PART OF THE PROJECT" data-en="NOKTRA THANKS YOU FOR BEING PART OF THE PROJECT">
      NOKTRA THANKS YOU FOR BEING PART OF THE PROJECT
    </div>
  </div>

  <div id="nft-gallery" class="nft-gallery">
    <h2>NFT Gallery</h2>
    <div class="neon-ornament" aria-hidden="true">
      <svg viewBox="0 0 260 20" preserveAspectRatio="xMidYMid meet">
        <defs>
          <linearGradient id="grad-neon" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#00ffcc"/>
            <stop offset="50%" stop-color="#ffffff"/>
            <stop offset="100%" stop-color="#00ffcc"/>
          </linearGradient>
        </defs>
        <path d="M5 10 Q 45 0, 85 10 T 165 10 T 245 10"/>
      </svg>
    </div>
    <div class="nft-items">
      <div class="nft-card">
        <img src="D3897B39-FBCA-41A6-9BC2-C88AF6DD2B6B.png" alt="NFT 1" loading="lazy" decoding="async">
        <p>Noktra Genesis #1</p>
      </div>
      <div class="nft-card">
        <img src="E7A36217-5496-4C3A-9439-87C9278E6F24.png" alt="NFT 2" loading="lazy" decoding="async">
        <p>Noktra Genesis #2</p>
      </div>
      <div class="nft-card">
        <img src="889DE7F5-6899-4172-A704-6EC2F9E3114A.png" alt="NFT 3" loading="lazy" decoding="async">
        <p>Noktra Genesis #3</p>
      </div>
    </div>
    <p class="nft-description"
       data-en="Noktra is my own project, a dream I'm realizing. Thank you for being a part of it. The token was born out of passion, faith, and the desire to create something of my own. Noktra isn't just a project—it's a feeling. Noktra will continue to grow—until the whole world hears about it."
       data-pl="Noktra is my own project, a dream I'm realizing. Thank you for being a part of it. The token was born out of passion, faith, and the desire to create something of my own. Noktra isn't just a project—it's a feeling. Noktra will continue to grow—until the whole world hears about it.">
       Noktra is my own project, a dream I'm realizing. Thank you for being a part of it. The token was born out of passion, faith, and the desire to create something of my own. Noktra isn't just a project—it's a feeling. Noktra will continue to grow—until the whole world hears about it.
    </p>
    <div class="share-row">
      <a id="share-twitter" href="#" target="_blank" rel="noopener">Udostępnij na Twitter</a>
      <a id="share-telegram" href="#" target="_blank" rel="noopener">Udostępnij na Telegram</a>
    </div>
  </div>

  <div class="language-switcher">
    
    
  </div>

  <div class="container">
    <h1 data-en="Noktra Airdrop" data-pl="Airdrop Noktra">Noktra Airdrop</h1>
    <p class="description" data-en="Noktra is a decentralized community token built on Solana. No inflation. No limits. For the people."
       data-pl="Noktra to zdecentralizowany token społecznościowy zbudowany na Solanie. Bez dodruku. Bez barier. Dla ludzi.">
       Noktra is a decentralized community token built on Solana. No inflation. No limits. For the people.
    </p>
    <div class="token-info">
      <p><strong data-en="Token" data-pl="Token">Token</strong>: NOK</p>
      <p><strong data-en="Total Supply" data-pl="Podaż">Total Supply</strong>: 1,000,000,000</p>
      <p><strong data-en="Network" data-pl="Sieć">Network</strong>: Solana</p>
      <p><strong>Token Address:</strong>
        <a href="https://solscan.io/token/48QzG8RhntaiPjY7z3mPqaDiK8TxDKetBKAKMZr1TbL" target="_blank" rel="noopener" id="token-solscan">Solscan</a>
        <button type="button" id="copy-token" class="linklike" data-addr="48QzG8RhntaiPjY7z3mPqaDiK8TxDKetBKAKMZr1TbL">Kopiuj</button>
      </p>
    </div>

    <p id="counter" style="text-align:center; font-weight:bold; margin-top:0.5rem; color:#00ffcc;">Zgłoszeń: 0</p>

    <form id="airdrop-form" autocomplete="off">
      <input type="text" id="address" placeholder="Solana Address" required
             inputmode="text" minlength="32" maxlength="60"
             pattern="[1-9A-HJ-NP-Za-km-z]{32,60}"
             title="Wklej poprawny adres Solana (base58, 32–60 znaków)"
             autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" />
      <input type="text" id="twitter" placeholder="Twitter Username" required
             inputmode="text" maxlength="32" title="@username bez spacji"
             autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" />
      <input type="text" id="telegram" placeholder="Telegram Username" required
             inputmode="text" maxlength="32" title="@username bez spacji"
             autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" />
      <button type="submit" data-en="Submit to Airdrop" data-pl="Zgłoś się do airdropu">Submit to Airdrop</button>
    </form>
    <p id="message"></p>
    <div class="socials">
      <a href="https://phantom.app/" target="_blank" rel="noopener">Phantom Wallet</a> |
      <a href="https://x.com/Noktra1755" target="_blank" rel="noopener">Twitter</a> |
      <a href="https://t.me/Noktra_AirDrop" target="_blank" rel="noopener">Telegram</a>
    </div>
  </div>

  <script src="script.js"></script>

  <script>
    (function(){
      const backend = (typeof window!=='undefined' && window.NOKTRA_BACKEND_URL) ? String(window.NOKTRA_BACKEND_URL) : '';
      const keyCount = 'noktra-airdrop-count';
      const keySub = 'noktra-airdrop-submissions';

      function getLocalCount(){ return parseInt(localStorage.getItem(keyCount) || '0', 10); }
      function setLocalCount(v){ localStorage.setItem(keyCount, String(v)); }
      function renderCount(v){
        var el = document.getElementById('counter');
        if(!el) return;
        var n = (typeof v==='number') ? v : getLocalCount();
        el.textContent = 'Zgłoszeń: ' + n;
      }
      async function fetchGlobal(){
        if(!backend) return;
        try{
          const r = await fetch(backend.replace(/\/$/,'') + '/count');
          if(!r.ok) return;
          const d = await r.json();
          if(typeof d.count === 'number'){ setLocalCount(d.count); renderCount(d.count); }
        }catch(_){}
      }
      function isValidAddr(a){ return !!a && a.length>=32 && a.length<=60 && /^[1-9A-HJ-NP-Za-km-z]+$/.test(a); }
      function getSubmitted(){ try{ return JSON.parse(localStorage.getItem(keySub)||'{}'); }catch{return {}} }
      function saveSubmitted(m){ localStorage.setItem(keySub, JSON.stringify(m)); }
      function setMsg(t,err){ var m=document.getElementById('message'); if(!m) return; m.textContent=t; m.style.color=err?'#ff6b6b':'#00ff88'; }

      document.addEventListener('DOMContentLoaded', function(){
        renderCount();
        fetchGlobal();

        var f = document.getElementById('airdrop-form');
        if(!f) return;

        f.addEventListener('submit', async function(e){
          e.preventDefault();
          var addr = document.getElementById('address')?.value.trim();
          var tw = document.getElementById('twitter')?.value.trim();
          var tg = document.getElementById('telegram')?.value.trim();

          if(!isValidAddr(addr)) return setMsg('Nieprawidłowy adres Solana.', true);
          if(!tw || !tg) return setMsg('Uzupełnij Twitter oraz Telegram.', true);

          var submitted = getSubmitted();
          if(submitted[addr]) return setMsg('Ten adres już złożył zgłoszenie.', true);

          try{
            if(backend){
              const r = await fetch(backend.replace(/\/$/,'') + '/submit', {
                method:'POST', headers:{'Content-Type':'application/json'},
                body: JSON.stringify({ address: addr, twitter: tw, telegram: tg })
              });
              if(r.ok){
                const d = await r.json();
                if(d?.ok && typeof d.count==='number'){
                  submitted[addr] = { tw, tg, ts: Date.now() }; saveSubmitted(submitted);
                  setLocalCount(d.count); renderCount(d.count); f.reset(); return setMsg('Zgłoszenie przyjęte. Dziękujemy!', false);
                }
                if(d?.error==='duplicate') return setMsg('Ten adres już złożył zgłoszenie.', true);
              }
            }
          }catch(_){}

          submitted[addr] = { tw, tg, ts: Date.now() }; saveSubmitted(submitted);
          setLocalCount(getLocalCount()+1); renderCount(); f.reset(); setMsg('Zgłoszenie przyjęte (lokalnie).', false);
        });
      });
    })();
  </script>

  <script>
    (function(){
      const btn=document.getElementById('copy-token'); if(!btn) return;
      btn.addEventListener('click', async ()=>{
        try{ await navigator.clipboard.writeText(btn.dataset.addr); showToast('Skopiowano adres tokena'); }
        catch(_){ showToast('Nie udało się skopiować'); }
      });
      function showToast(t){
        let el=document.getElementById('toast'); if(!el){ el=document.createElement('div'); el.id='toast'; document.body.appendChild(el); }
        el.textContent=t; el.className='show'; setTimeout(()=>{ el.className=''; },1800);
      }
    })();
  </script>

  <script>
    (function(){
      document.addEventListener('click', function(e){
        const img=e.target.closest('.nft-card img'); if(!img) return;
        e.preventDefault();
        const src=img.getAttribute('src');
        const wrap=document.createElement('div');
        wrap.className='lightbox-backdrop';
        wrap.innerHTML='<img src="'+src+'" alt="">';
        wrap.addEventListener('click',()=>wrap.remove());
        document.addEventListener('keydown',function esc(ev){ if(ev.key==='Escape'){ wrap.remove(); } },{once:true});
        document.body.appendChild(wrap);
      }, false);
    })();
  </script>

  <script>
    (function(){
      // Reveal animacje
      document.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.nft-card, .container').forEach(el=>el.classList.add('reveal'));
        const io=new IntersectionObserver((entries)=>{
          entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target); } });
        },{threshold:.15});
        document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
      });

      // Confetti po sukcesie
      function confettiBurst(){
        const canvas=document.createElement('canvas');
        Object.assign(canvas.style,{position:'fixed',inset:'0',pointerEvents:'none',zIndex:99998});
        document.body.appendChild(canvas);
        const ctx=canvas.getContext('2d');
        const resize=()=>{canvas.width=innerWidth; canvas.height=innerHeight;};
        resize(); addEventListener('resize',resize,{once:true});
        const colors=['#00ffcc','#00e6b8','#ffffff','#99ffee','#66ffd9'];
        const parts=Array.from({length:80}).map(()=>({
          x:Math.random()*canvas.width,
          y:-20-Math.random()*40,
          r:3+Math.random()*4,
          c:colors[Math.floor(Math.random()*colors.length)],
          vy:2+Math.random()*3,
          vx:(Math.random()-.5)*2,
          g:.05+.02*Math.random(),
          a:1
        }));
        let t=0; const maxT=90;
        (function loop(){
          ctx.clearRect(0,0,canvas.width,canvas.height);
          parts.forEach(p=>{
            p.vy+=p.g; p.x+=p.vx; p.y+=p.vy; p.a-=.008;
            ctx.globalAlpha=Math.max(p.a,0);
            ctx.fillStyle=p.c;
            ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
          });
          t++; if(t<maxT){ requestAnimationFrame(loop); } else { canvas.remove(); }
        })();
      }

      // Nasłuchuj sukcesu
      document.addEventListener('DOMContentLoaded', function(){
        const msg=document.getElementById('message'); if(!msg) return;
        const obs=new MutationObserver(()=>{
          const text=(msg.textContent||'').toLowerCase();
          if(text.includes('zgłoszenie przyjęte')){ confettiBurst(); }
        });
        obs.observe(msg,{childList:true, characterData:true, subtree:true});
      });

      // Linki udostępnienia z aktualnym URL
      document.addEventListener('DOMContentLoaded', function(){
        const url=encodeURIComponent(location.href);
        const txt=encodeURIComponent('Noktra Genesis on Solana — join the airdrop!');
        const tw=document.getElementById('share-twitter');
        const tg=document.getElementById('share-telegram');
        if(tw) tw.href=`https://twitter.com/intent/tweet?text=${txt}&url=${url}`;
        if(tg) tg.href=`https://t.me/share/url?url=${url}&text=${txt}`;
      });
    })();
  </script>

  <script>
    (function(){
      // Splash: odtwórz animację (fade+blur) i usuń warstwę
      document.addEventListener('DOMContentLoaded', function(){
        var splash=document.getElementById('splash');
        if(!splash) return;
        document.body.classList.add('splash-lock');
        splash.classList.add('play'); // startuje animację logo
        setTimeout(function(){
          splash.classList.add('hide');           // wygaszanie tła splash
          document.body.classList.remove('splash-lock');
          setTimeout(function(){ splash.remove(); }, 800);
        }, 1800); // ile splash na ekranie (ms)
      });
    })();
  </script>

  <div id="toast"></div>
</body>
</html>
